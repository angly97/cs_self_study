# 6. 로드 밸런싱 (Load Balancing)



### 1. 로드 밸런싱

* 여러 CPU나 저장장치같은 컴퓨터 자원으로 작업 나누는 것

* 배경/ 사용 이유

  * 많은 트래픽을 1대의 서버로 감당하기 어려워서

  * 해결

    * Scale-up

      →   하드웨어 성능 향상 & 비쌈 

      →   **한 대의 서버에서 데이터를 처리하므로, 데이터 갱신이 자주 일어나는 데이터베이스 서버에 적합**

    * Scale-out
    
      →   여러 서버를 두고, 로드밸런싱을 통해 나눠서 일하기 => 단일 실패점을 없앨 수 있어서 효과적
      
      →   **보편적인 웹 서비스**



### 2. 로드 밸런서의 서버 선택 방식

* 로드 밸런서는 작업을 여러 서버에 분산
  * 따라서 트래픽 많으면 서버 수 늘리고, 로드밸런서로 관리하는게 효과적
* 방식
  * 라운드 로빈
    * 요청이 들어오는 순서대로 순차 분배 (가장 단순)
    * 처리시간이 짧은 애플리케이션의 경우 균등한 분배 가능
  * 최소연결 방식(Least Connctions)
    * 연결 갯수가 가장 적은 서버 선택
    * 트래픽으로 세션 길어지는 경우에 좋음
  * **IP 해시 방식**
    
    * 사용자 IP의 해시값에 따라 서버 선택
    * 같은 사용자는 항상 같은 서버로 연결됨
    * 데이터 교환 최소화하기 위해, 다른 웹 서버에게 세션공유를 하지 않는 경우 사용
    
      > 동시접속자가 많으면, 여러 서버를 이용하고 => 이 때 세션 공유를 함
      >
      > => 그래서 데이터 교환이 많음
    
      * 그래서, 사용자가 늘 같은 서버로 매핑되면 => 세션 정보를 공유할 필요 없음
      * 다만, 특정 세션 사용자가 많아지면, 트래픽 쏠림 현상 발생
      * 따라서, 사용자가 많되, 그 사용자들의 접속이 균등할 때, 효율적



### 3. 로드 밸런서 장애 대비

* 로드 밸런서를 이중화하여 대비한다
  * Active 상태와 Passive 상태로 분류
  * Active한 로드밸런서 동작하지 않으면 Passive 로드밸런서를 Active로 돌려서 운영