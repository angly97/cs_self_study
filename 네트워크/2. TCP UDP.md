# 2. TCP / UDP



### 1. TCP (Transmission Control Protocol; 전송 제어 프로토콜) 

* 확인 응답 절차를 거침

  * 신뢰성 높다
  * 속도 느림

* 연결형 서비스

  * **송신자, 수신자는 소켓(Socket)이라는 종단점 생성하여 통신**
  * 정해진 경로가 있어서 모든 패킷이 그 경로로 감
  * **전송 순서 보장 (순차 전송)**

* **멀티캐스팅 & 브로드캐스팅 불가**

  * 일대일 통신

* **데이터 전송 단위 / 형태**

  * Segment
  * 스트림 전송
    * 전송 데이터 크기 무제한

* 흐름제어 (Flow Control)

  * 송수신 측 속도 차이 해결

  * 너무 많은 패킷 받지 않도록, 수신측이 자신의 상태를 송신측에 보냄
  * 수신측 속도 < 송신측 속도 => 이 경우 문제
  
  * 방식
  
       * stop and wait (정지-대기)
  
         →   매번 전송한 패킷의 확인 응답을 받고, 다음 패킷 전송
  
       * 슬라이딩 윈도우 
  
            →   수신측에서 설정한 윈도우 크기 내에선, 송신측에서 확인응답없어도 세그먼트 전송
  
            →   윈도우에 포함되는 패킷들을 보내고, ACK응답이 오면 윈도우를 옆으로 옮기며 다음 패킷 전송
  
* 혼잡제어 (Congestion Control)

  * 네트워크 내 패킷 수가 너무 많아지는 것을 방지/제거

    * ex. 대형 네트워크에서 한 라우터에 데이터 몰릴 경우

  * 방식

    * AIMD (Additive Increase Multiplicative Decrease)

      →   처음에 패킷을 1개씩 전송

      →   문제없이 도착하면 window 크기 1씩 증가시키며 전송

      →   패킷 전송 실패 or 일정시간 초과하면, 윈도우 크기 절반으로 줄임

      →   특징

      > * 초기에 높은 대역폭 사용 불가 
      > * 오랜 시간 걸림 
      > * 혼잡 예방 못하고 혼잡해지고 나서 해결

    * Slow Start (느린 시작)

      →   윈도우 사이즈를 1부터 시작

      →   패킷 손실 일어날 때까지 지수승으로 증가시킴 (2, 4, 8, 16 ...)

      →   패킷 손실 일어나면 윈도우 사이즈 1로 만듦

      →   특징

      > * 한번 혼잡 발생하면 예측 가능
      > * 혼잡 발생했던, 윈도우 사이즈 절반까지는 지수승으로 늘리고, 그 이후는 1씩 증가
      
    * Fast Retransmit (빠른 재전송)
    
      →   혼잡 제어에 추가된 정책 (느린 시작으로 시작)
    
      →   수신측에서 먼저 도착해야할 패킷이 아니라 다음 패킷이 도착한 경우, 유실된 패킷에 대한 ACK 패킷 전송
    
      →   송신측은 중복된 순번의 ACK를 3개 받으면, 재전송 & **혼잡 인지하고 윈도우 사이즈 줄임**
    
    * Fast Recovery(빠른 회복)
    
      <img src="https://user-images.githubusercontent.com/70613905/163705181-b3794e87-1f5e-4009-bc66-d9fdefa87671.JPG" style="width:50%;height:50%;" />
      
      →  느린시작에서, 혼잡 발생 시, 윈도우 사이즈 1로 줄이지 않고, 반으로 줄임 => 이후 1씩 선형증가
    
      

### 2. UDP(User Datagram Protocol)

* 확인 응답 절차 X

  * 신뢰성 낮음, 비신뢰성

  * 속도 빠름

* 비연결성

  * 연결 자체가 없어서 => 서버 소켓, 클라이언트 소켓 구분이 없음
    * 소켓 대신 IP 기반으로 데이터 전송
    
  * 정해진 경로가 없어서 각 패킷이 다른 경로로 갈 수 있음

  * 전송 순서 보장 x

* 멀티캐스팅 & 브로드캐스팅 가능

  * 서버와 클라이언트 다대다 연결 가능

* 실시간

  * 신뢰성보다 연속성이 중요하고

  * 패킷이 손실된 경우 재전송 요청이 없기 때문에

* 데이터 전송 단위 / 형태

  *  Datagram = 독립적인 패킷
  * 데이터그램(메시지) 단위로 전송되기 때문에, 크기 초과하면 잘라서 보냄

* 흐름제어 & 혼잡제어 지원 x

