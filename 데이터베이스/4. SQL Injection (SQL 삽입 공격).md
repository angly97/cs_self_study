# 4. SQL Injection (SQL 삽입 공격)



### 1. SQL Injection

* 해커가 조작된 쿼리문을 전달해서 악의적인 명령 실행시키는 공격

* 방법

  * 인증 우회 (Auth Bypass; AB)

    * 주로 로그인 페이지가 타겟

    * 로그인 인증 쿼리문이 무조건 참이 되게하여 무력화

      1. ID 입력에 => 유효한 id'--'

         >* select * from user where id = '***유효한 id'--'***' and pw='';
         >* -- 가 주석 처리이므로, -- 뒤가 주석처리 됨
         >* 뒤에 더 필요한 입력 안해도 아이디 만으로 로그인 성공

      2. ID만 정상 입력 & PW에 ' or '1'='1 입력

         >* select * from user where id = '유효한 id and pw='**' or '1'='1**';
         >
         >* 유효하지 않은 비번임에도 불구하고 로그인 성공
    
  * 데이터 노출 (Data Disclisure; DD)
  
    * 시스템 에러 메시지 이용한 공격
    * 해커들은 **일부러 쿼리에 에러 발생시킨 후**, 나오는 에러메시지로 해킹에 필요한 **테이블** 정보 등을 획득



### 2. 방어

* input 값을 받을 때, 특수문자 검사
* preparestatement 사용하기
  * statement
    * SQL 실행하는 객체
  * **입력값을 포함한 상태로 SQL 문법검사를 하지 않기 때문에, 문법을 통한 공격이 불가능**
* 에러메시지 감추기
  * 실제 테이블이 아닌 view를 이용
  * 일반 사용자는 view에 접근하여 실제 테이블 정보 얻을 수 없게 함