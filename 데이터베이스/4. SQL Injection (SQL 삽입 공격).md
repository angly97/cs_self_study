# 4. SQL Injection (SQL 삽입 공격)



### 1. SQL Injection

* 해커가 조작된 SQL 쿼리문을 DB에 전달되어 비정상적인 명령 실행시키는 공격

* 방법

  * 인증 우회 (Auth Bypass; AB)

    * 주로 로그인 페이지가 타겟

    * 로그인 인증 쿼리문이 무조건 참이 되게하여 무력화

      1. ID 입력에 => 유효한 id'--'

         >* select * from user where id = '***유효한 id'--'***' and pw='';
         >* -- 가 주석 처리이므로, -- 뒤의 비번 작성 부분 전부 주석처리 됨
         >* PW입력 안해도 로그인 성공

      2. ID만 정상 입력 & PW에 ' or '1'='1 입력

         >* select * from user where id = '유효한 id and pw='**' or '1'='1**';
         >
         >* '' 와 1=1 중 하나만 참이면 로그인 성공이므로
         >* ID만 가지고 로그인 성공

  * 데이터 노출 (Data Disclisure; DD)

    * 시스템 에러 메시지 이용한 공격
    * 해커들은 일부러 쿼리에 에러 발생시킨 후, 나오는 에러메시지로 해킹에 필요한 정보를 획득



### 2. 방어

* input 값을 받을 때, 특수문자 검사
* SQL 서버 오류 발생 시, 에러메시지 감추기
  * 실제 테이블이 아닌 view를 이용
  * 일반 사용자는 view로만 접근하여 에러 볼 수 없도록 함
* preparestatement 사용하기
  * statement
    * SQL 실행하는 객체
  * 특수문자를 자동으로 escaping 해줌
    * 특수문자 앞에 역슬래시 삽입하는 식으로 이스케이프 문자로 바꿈